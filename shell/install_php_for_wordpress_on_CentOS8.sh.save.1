# This *script* should not be execute in any case.
# It's just a memo for steps to compile install php for wordpress.
# PHP: 7.4.7
# Wordpress 5.4.2

# install dnf official and epel dependences
dnf config-manager --set-enabled PowerTools
dnf install epel-release
dnf install gcc gcc-c++ autoconf automake tar xz libtool bison libcurl libcurl-devel libsodium libsodium-devel openssl openssl-devel libzip libzip-devel libssh2 libssh-devel ImageMagick ImageMagick-devel ghostscript zlib zlib-devel systemd-devel libxml2 libxml2-devel sqlite sqlite-devel re2c oniguruma oniguruma-devel

# compile install re2c
### /etc/profile.d/re2c_path.sh
# export RE2C_PATH=/usr/local/re2c
###
curl -LO https://github.com/skvadrik/re2c/releases/download/1.3/re2c-1.3.tar.xz
tar -xf re2c-1.3.tar.xz
cd re2c-1.3
autoreconf -i -W all
./configure --prefix=$RE2C_PATH
make
#make check
make install
cd ..

# compile install oniguruma
curl -LO https://github.com/kkos/oniguruma/releases/download/v6.9.5_rev1/onig-6.9.5-rev1.tar.gz
tar -xf onig-6.9.5-rev1.tar.gz
cd onig-6.9.5
./configure
make
make install
#make uninstall
cd ..
### /etc/profile.d/pkg_config_path.sh
# export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
###

# php configureflags
./configure --with-curl --enable-exif --enable-mbstring --with-mysqli --with-sodium --with-openssl --with-zip --with-zlib  --enable-ftp --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-fpm-systemd --disable-short-tags --with-libdir=lib64
